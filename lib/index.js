"use strict";var __extends=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},__decorate=this&&this.__decorate||function(e,t,o,r){var n,i=arguments.length,p=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)p=Reflect.decorate(e,t,o,r);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(p=(i<3?n(p):i>3?n(t,o,p):n(t,o))||p);return i>3&&p&&Object.defineProperty(t,o,p),p},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},path=require("path"),development_core_1=require("development-core"),_=require("lodash"),cache=require("gulp-cached"),ts=require("gulp-typescript"),sourcemaps=require("gulp-sourcemaps"),uglify=require("gulp-uglify"),babel=require("gulp-babel"),TsCompile=function(e){function t(t){e.call(this,t)}return __extends(t,e),t.prototype.getInfo=function(){return this.info.name=this.info.name||"tscompile",this.info},t.prototype.tsPipes=function(e,t,o){var r=this,n=e.option,i=[function(e){return cache("typescript")},function(e){return sourcemaps.init()}];return n.tsPipes&&n.tsPipes.length>0&&i.concat(n.tsPipes),i.push(function(e){return r.getTsProject(e)}),i},t.prototype.source=function(e,t,o){var r=this.getInfo(),n=o.src(e.getSrc(r));return this.pipes2Promise(n,e,t,o,this.tsPipes(e,t,o)).then(function(t){return e.oper&development_core_1.Operation.build?t.js:[t.js,_.extend(t.dts,{nonePipe:!0})]})},t.prototype.pipes=function(t,o,r){var n=t.option,i=[function(e){return sourcemaps.write(n.sourceMaps||"./sourcemaps")}];return _.isUndefined(n.uglify)&&(n.uglify=!0),n.uglify&&i.splice(0,0,{oper:development_core_1.Operation.deploy|development_core_1.Operation.release,toTransform:function(e){return _.isBoolean(n.uglify)?uglify():uglify(n.uglify)}}),i.concat(e.prototype.pipes.call(this,t,o,r))},t.prototype.getTsProject=function(e){var t=e.option;if(t.tsconfig)return ts(t.tsconfig);var o=ts.createProject(path.join(e.env.root||"",t.tsconfigFile||"./tsconfig.json"));return o()},t=__decorate([development_core_1.task({oper:development_core_1.Operation.default|development_core_1.Operation.autoWatch}),__metadata("design:paramtypes",[Object])],t)}(development_core_1.PipeTask);exports.TsCompile=TsCompile;
//# sourceMappingURL=sourcemaps/index.js.map
