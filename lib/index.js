"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},__decorate=function(e,t,o,r){var n,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"===("undefined"==typeof Reflect?"undefined":_typeof(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var u=e.length-1;u>=0;u--)(n=e[u])&&(c=(i<3?n(c):i>3?n(t,o,c):n(t,o))||c);return i>3&&c&&Object.defineProperty(t,o,c),c},__metadata=function(e,t){if("object"===("undefined"==typeof Reflect?"undefined":_typeof(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},path=require("path"),development_core_1=require("development-core"),_=require("lodash"),cache=require("gulp-cached"),ts=require("gulp-typescript"),sourcemaps=require("gulp-sourcemaps"),uglify=require("gulp-uglify"),babel=require("gulp-babel"),TsCompile=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _inherits(t,e),_createClass(t,[{key:"getInfo",value:function(){return this.info.name=this.info.name||"tscompile",this.info}},{key:"source",value:function e(t,o,r){var n=this.getInfo(),e=r.src(t.getSrc(n)).pipe(cache("typescript")).pipe(sourcemaps.init()).pipe(this.getTsProject(t));return t.oper&development_core_1.Operation.build?e.js:[e.js,_.extend(e.dts,{nonePipe:!0})]}},{key:"pipes",value:function e(t,o,r){var n=t.option,e=[function(e){return babel(n.babelOption||{presets:["es2015"]})},function(e){return sourcemaps.write(n.sourceMaps||"./sourcemaps")}];return _.isUndefined(n.uglify)&&(n.uglify=!0),n.uglify&&e.splice(1,0,{oper:development_core_1.Operation.deploy|development_core_1.Operation.release,toTransform:function(e){return _.isBoolean(n.uglify)?uglify():uglify(n.uglify)}}),e}},{key:"getTsProject",value:function(e){var t=e.option;if(t.tsconfig)return ts(t.tsconfig);var o=ts.createProject(path.join(e.env.root||"",t.tsconfigFile||"./tsconfig.json"));return o()}}]),t}(development_core_1.PipeTask);TsCompile=__decorate([development_core_1.task({oper:development_core_1.Operation.default|development_core_1.Operation.autoWatch}),__metadata("design:paramtypes",[Object])],TsCompile),exports.TsCompile=TsCompile;
//# sourceMappingURL=sourcemaps/index.js.map
